\subsection{Giới thiệu về WebSocket và Real-time Communication}

\subsubsection{Khái quát}

WebSocket là một protocol cung cấp full-duplex communication channels qua một TCP connection, khác với HTTP traditional request-response pattern cho phép server push data đến client bất kỳ lúc nào mà không cần client request. WebSocket có persistent connection được giữ mở liên tục không cần reconnect cho mỗi message, bi-directional communication cho phép cả client và server gửi messages đến nhau một cách độc lập, low latency do không có HTTP overhead và handshake cho mỗi message, và sử dụng protocol ws:// cho unencrypted connections hoặc wss:// cho TLS encrypted connections trong production. WebSocket đặc biệt phù hợp cho các ứng dụng yêu cầu real-time updates như chat applications, live notifications, collaborative editing, gaming, và financial trading platforms.

\subsubsection{Socket.io và NestJS integration}

Socket.io là một library hỗ trợ real-time, bi-directional communication được xây dựng trên WebSocket với nhiều features bổ sung. Socket.io cung cấp automatic reconnec\-tion tự động kết nối lại khi connection bị mất do network issues, Rooms và Namespaces để group connections cho targeted broadcasting giúp organize clients, acknowledgements với callbacks để confirm message delivery đảm bảo reliable messaging, binary support cho phép gửi binary data như images và files, và fallback mechanism tự động chuyển sang HTTP long-polling khi WebSocket không available do firewalls hoặc proxies.

NestJS cung cấp built-in support cho WebSockets với Socket.io adapter thông qua decorators và architecture patterns quen thuộc. @WebSocketGateway decorator định nghĩa WebSocket gateway class, @SubscribeMessage decorator handle incoming messages từ specific events, @WebSocketServer decorator inject Socket.io server instan\-ce để emit events, Guards và Pipes có thể reuse từ REST APIs cho WebSocket connecti\-ons để validate authentication và transform data, và Interceptors transform data before hoặc after handling messages. Kiến trúc này cho phép developers áp dụng same patterns và best practices từ REST APIs sang WebSocket, giảm learning curve và maintain code consistency.

\subsubsection{Vận dụng vào đề tài}

Notification Service được xây dựng bằng NestJS WebSocket Gateway với Socket.io adapter để cung cấp real-time communication cho toàn hệ thống. Service push notificat\-ions đến users ngay lập tức khi có events như new member joined workspace, file uploaded, mention trong comments, hoặc workspace settings changed, đảm bảo users luôn cập nhật thông tin mới nhất mà không cần refresh page.

Rooms-based architecture được implement với mỗi workspace là một Socket.io room, cho phép broadcast events đến tất cả members trong workspace một cách hiệu quả mà không cần iterate qua từng user. User-specific events được gửi đến individual users dựa trên user ID, phù hợp cho private notifications như password changed, account locked, hoặc direct mentions. Dashboard metrics được cập nhật real-time hiển thị storage usage, active members, recent activities mà không cần polling APIs. Online status tracking sử dụng connection và disconnection events để broadcast member online/offline status đến workspace members, giúp users biết ai đang active. Authentication được enforce bằng Guards validate JWT token khi clients establish WebSocket connection, ensure chỉ authenticated users mới có thể connect và receive notifications phù hợp với permissions của họ.
